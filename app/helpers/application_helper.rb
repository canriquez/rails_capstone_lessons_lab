module ApplicationHelper
  require 'date'
  def roles_options
    rt = User.roles.map { |k, _v| [k.split('_').first.capitalize, k] }

    rt
  end

  def type_options
    rt = Transaction.booking_types.map { |k, _v| [k.split('_').first.capitalize, k] }

    rt
  end

  def auth_course_options
    course_options = Group.select('name as course_name, id as course_taught_id')
      .where(id: current_user.authored_courses)
    c_options = course_options.map { |a| [a.course_name, a.course_taught_id] }
    c_options
  end

  def session_duration_options
    options = (1..8).map { |num| [(num * 15).to_s + ' min', num * 15] }
    options
  end

  def svg(name)
    file_path = "#{Rails.root}/app/assets/images/icons/#{name}.svg"
    return File.read(file_path).html_safe if File.exist?(file_path)

    fallback_path = "#{Rails.root}/app/assets/images/icons/#{name}.png"
    return image_tag("icons/#{name}.png") if File.exist?(fallback_path)
    self.public_send(name) #final fullback - ensuring production will work
  end


  def toggle_icon(value)
    value ? svg('on') : svg('off')
  end

  def to_date(record)
    record.to_s[0..18]
    
  end

  def status_tag(val)
    tag = '<p class="mt-0 mb-0 d-flex justify-content-between align-items-center">'
    tag += '<span class="badge badge-pill badge-light">'
    tag += val
    if val == 'generated'
      tag += '</span>'
    else
      tag += ' by student</span>'
      tag += '<span class="course-on-btn mt-0 mb-0">'
    end
    tag += svg('check')
    tag += '</span><p>'
    tag.html_safe
  end

  def safe_puts(field)
    return '' if field.nil?

    field
  end 

  def bookings
    '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" 
    viewBox="0 0 24 24"><path d="M15 12h-10v1h10v-1zm-4 2h-6v1h6v-1zm4-6h-10v1h10v-1zm0 2h-10v1h10v-1zm0-6h-10v1h10v-1zm0 
    2h-10v1h10v-1zm7.44 10.277c.183-2.314-.433-2.54-3.288-5.322.171
    1.223.528 3.397.911 5.001.089.382-.416.621-.586.215-.204-.495-.535-2.602-.82-4.72-.154-1.134-1.661-.995-1.657.177.005 
    1.822.003 3.341 0 6.041-.003 2.303 1.046 2.348 1.819 4.931.132.444.246.927.339 
    1.399l3.842-1.339c-1.339-2.621-.693-4.689-.56-6.383zm-6.428 
    1.723h-13.012v-16h14v7.894c.646-.342 1.348-.274 1.877.101l.123-.018v-8.477c0-.828-.672-1.5-1.5-1.5h-15c-.828 
    0-1.5.671-1.5 1.5v17c0 .829.672 1.5 1.5 1.5h13.974c-.245-.515-.425-1.124-.462-2z"/>
    </svg>'.html_safe
  end

  def courses
    '<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" 
    fill-rule="evenodd" clip-rule="evenodd"><path d="M24 17.99l-7.731-.001 2.731 
    4h-1.311l-2.736-4h-1.953l-2.736 
    4h-1.264l2.732-4h-2.95v-1h8.218v-1h3v1h3v-14h-17v.447h-1v-1.447h19v16zm-17.241-9c.649 
    0 1.293-.213 1.692-.436.755-.42 2.695-1.643 
    3.485-2.124.215-.13.496-.082.654.114l.009.01c.164.205.145.5-.043.68l-3.371 3.214c-.521.498-.822 
    1.183-.853 1.902-.095 2.207-.261 6.912-.332 8.834-.016.45-.386.806-.836.806h-.001c-.444 
    0-.786-.348-.836-.788-.111-.982-.329-3.279-.427-4.212-.04-.384-.279-.613-.584-.614-.304-.002-.523.226-.548.608-.062.921-.266 
    3.249-.342 4.221-.034.441-.397.785-.84.785h-.001c-.452 
    0-.823-.356-.842-.809-.097-2.34-.369-8.963-.369-8.963l-1.287 
    2.331c-.14.254-.445.364-.715.26l-.001-.001c-.228-.088-.371-.305-.371-.54l.022-.157 
    1.244-4.393c.122-.43.515-.727.963-.727h4.53zm7.241 2h5v-1h-5v1zm0-2h7v-1h-7v1zm-8.626-5c1.241 
    0 2.25 1.008 2.25 2.25s-1.009 2.25-2.25 2.25c-1.242 0-2.25-1.008-2.25-2.25s1.008-2.25 2.25-2.25zm8.626 
    3h7v-1h-7v1z"/>
    </svg>'.html_safe
  end

  def back
    '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M17.026 22.957c10.957-11.421-2.326-20.865-10.384-13.309l2.464 2.352h-9.106v-8.947l2.232 
    2.229c14.794-13.203 31.51 7.051 14.794 17.675z"/>
    </svg>'.html_safe 
  end

  def Check_ok
    '<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 480">
    <path d="M320.5,38C206.45,38,114,130.45,114,244.5S206.45,451,320.5,451,527,358.55,527,244.5,434.55,38,
    320.5,38ZM309.79,297.79,256.9,242.43l8.35-8.61,40.9,24.44L376.69,192l7.16,7.16Z"/>
    </svg>'.html_safe 
  end

  def check
    '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M23.334 11.96c-.713-.726-.872-1.829-.393-2.727.342-.64.366-1.401.064-2.062-.301-.
    66-.893-1.142-1.601-1.302-.991-.225-1.722-1.067-1.803-2.081-.059-.723-.451-1.378-1.062-1.77-.609-.
    393-1.367-.478-2.05-.229-.956.347-2.026.032-2.642-.776-.44-.576-1.124-.915-1.85-.915-.725 
    0-1.409.339-1.849.915-.613.809-1.683 1.124-2.639.777-.682-.248-1.44-.163-2.05.229-.61.392-1.003 
    1.047-1.061 1.77-.082 1.014-.812 1.857-1.803 2.081-.708.16-1.3.642-1.601 1.302s-.277 1.422.065 
    2.061c.479.897.32 2.001-.392 2.727-.509.517-.747 1.242-.644 1.96s.536 1.347 1.17 1.7c.888.495 
    1.352 1.51 1.144 2.505-.147.71.044 1.448.519 1.996.476.549 1.18.844 1.902.798 1.016-.063 1.953.54 
    2.317 1.489.259.678.82 1.195 1.517 1.399.695.204 1.447.072 2.031-.357.819-.603 1.936-.603 2.754 0 
    .584.43 1.336.562 2.031.357.697-.204 1.258-.722 1.518-1.399.363-.949 1.301-1.553 2.316-1.489.724.046 
    1.427-.249 1.902-.798.475-.548.667-1.286.519-1.996-.207-.995.256-2.01 1.145-2.505.633-.354 1.065-.982 
    1.169-1.7s-.135-1.443-.643-1.96zm-12.584 5.43l-4.5-4.364 1.857-1.857 2.643 2.506 5.643-5.784 1.857 
    1.857-7.5 7.642z"/>
    </svg>'.html_safe
  end

  def edit
    '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M18 13.45l2-2.023v4.573h-2v-2.55zm-11-5.45h1.743l1.978-2h-3.721v2zm1.361 
    3.216l11.103-11.216 4.536 4.534-11.102 11.218-5.898 1.248 1.361-5.784zm1.306 3.176l2.23-.472 
    9.281-9.378-1.707-1.707-9.293 9.388-.511 2.169zm3.333 
    7.608v-2h-6v2h6zm-8-2h-3v-2h-2v4h5v-2zm13-2v2h-3v2h5v-4h-2zm-18-2h2v-4h-2v4zm2-6v-2h3v-2h-5v4h2z"/>
    </svg>'.html_safe
  end

  def enroll
    '<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd">
    <path d="M20 15h4.071v2h-4.071v4.071h-2v-4.071h-4.071v-2h4.071v-4.071h2v4.071zm-8 
    6h-12v-2h12v2zm0-4.024h-12v-2h12v2zm0-3.976h-12v-2h12v2zm12-4h-24v-2h24v2zm0-4h-24v-2h24v2z"/>
    </svg>'.html_safe
  end
  
  def students
    '<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" 
    fill-rule="evenodd" clip-rule="evenodd"><path d="M20.997 18.529c-.372.223-1.044.565-1.997.904v-5.038c-3.979.327-6.
    323 1.521-7 1.954-.677-.433-3.022-1.627-7-1.954v5.037c-.954-.339-1.625-.681-1.996-.902l-.004-1.944c-.008-2.036.
    06-2.531 1.863-2.929 2.28-.507 4.616-.775 5.225-2.323.282-.713.117-1.509-.488-2.365-1.588-2.246-2.007-4.36-1.
    183-5.952.645-1.244 2.018-2.017 3.583-2.017 1.562 0 2.932.766 3.573 1.999.827 1.587.409 3.709-1.175 5.973-.6.857-.
    762 1.652-.481 2.362.607 1.534 2.929 1.815 5.219 2.323 1.805.398 1.873.898 1.863 2.957l-.002 1.915zm-2.997 
    2.465c-1.588.287-3.853.925-5.5 1.638v-5.431c1.216-.783 3.666-1.472 5.5-1.707v5.5zm-6.5 1.638c-1.648-.713-3.912-1.
    351-5.5-1.638v-5.5c1.834.235 4.284.924 5.5 1.707v5.431zm7.851-9.952c-2.865-.632-5.663-.951-4.133-3.134 3.885-5.
    555.702-9.546-3.218-9.546s-7.12 4.022-3.218 9.546c1.557 2.203-1.328 2.516-4.134 3.134-2.56.566-2.656 1.783-2.648 
    3.91l.004 2.475s.957.758 2.996 1.431v1.352c.148.022 3.57.457 7 2.131 3.429-1.673 6.866-2.111 7-2.131v-1.352c2.039-.673 
    2.996-1.431 2.996-1.431l.003-2.451c.01-2.143-.077-3.366-2.648-3.934z"/>
    </svg>'.html_safe
  end

  def switch
    '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M14 12h-4v-12h4v12zm4.213-10.246l-1.213 1.599c2.984 1.732 5 4.955 5 8.647 0 5.514-4.486 10-10 
    10s-10-4.486-10-10c0-3.692 2.016-6.915 5-8.647l-1.213-1.599c-3.465 2.103-5.787 5.897-5.787 10.246 0 
    6.627 5.373 12 12 12s12-5.373 12-12c0-4.349-2.322-8.143-5.787-10.246z"/>
    </svg>'.html_safe
  end

  def trash_can
    '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M16 9v4.501c-.748.313-1.424.765-2 1.319v-5.82c0-.552.447-1 1-1s1 .448 1 
    1zm-4 0v10c0 .552-.447 1-1 1s-1-.448-1-1v-10c0-.552.447-1 1-1s1 .448 1 1zm1.82 
    15h-11.82v-18h2v16h8.502c.312.749.765 1.424 1.318 2zm-6.82-16c.553 0 1 .448 1 
    1v10c0 .552-.447 1-1 1s-1-.448-1-1v-10c0-.552.447-1 1-1zm14-4h-20v-2h5.711c.9 
    0 1.631-1.099 1.631-2h5.316c0 .901.73 2 1.631 2h5.711v2zm-1 2v7.182c-.482-.115-.983-.182-1.5-.182l-.5.
    025v-7.025h2zm3 13.5c0 2.485-2.017 4.5-4.5 4.5s-4.5-2.015-4.5-4.5 2.017-4.5 4.5-4.5 4.5 2.015 4.5 
    4.5zm-3.086-2.122l-1.414 1.414-1.414-1.414-.707.708 1.414 1.414-1.414 1.414.707.708 1.414-1.414 
    1.414 1.414.708-.708-1.414-1.414 1.414-1.414-.708-.708z"/>
    </svg>'.html_safe
  end

  def view
    '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
    <path d="M12.015 7c4.751 0 8.063 3.012 9.504 4.636-1.401 1.837-4.713 
    5.364-9.504 5.364-4.42 0-7.93-3.536-9.478-5.407 1.493-1.647 4.817-4.593 9.478-4.593zm0-2c-7.569 
    0-12.015 6.551-12.015 6.551s4.835 7.449 12.015 7.449c7.733 0 11.985-7.449 11.985-7.449s-4.291-6.551-11.
    985-6.551zm-.015 3c-2.21 0-4 1.791-4 4s1.79 4 4 4c2.209 0 4-1.791 4-4s-1.791-4-4-4zm-.004 3.999c-.
    564.564-1.479.564-2.044 0s-.565-1.48 0-2.044c.564-.564 1.479-.564 2.044 0s.565 1.479 0 2.044z"/>
    </svg>'.html_safe
  end

  def toggle_off
    '<?xml version="1.0" encoding="utf-8"?>
    <!-- Generator: Adobe Illustrator 24.1.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       viewBox="0 0 496 496" style="enable-background:new 0 0 496 496;" xml:space="preserve">
    <style type="text/css">
      .st0{fill:#E7E7E7;}
      .st1{fill:#AAAAA9;}
      .st2{fill:#FFFFFF;}
      .st3{fill:#E9F4F2;}
    </style>
    <path class="st0" d="M496,252.8c0,88-71.2,155.2-158.4,155.2H158.4C71.2,408,0,340.8,0,252.8v-9.6C0,155.2,71.2,88,158.4,88h178.4
      c88,0,158.4,67.2,158.4,155.2v9.6H496z"/>
    <g>
      <path class="st1" d="M0.4,256v-12.8C0.4,155.2,71.6,88,158.8,88h178.4c88,0,158.4,67.2,158.4,155.2V256"/>
      <path class="st1" d="M368.4,252.8v-9.6c0-88-71.2-155.2-158.4-155.2h-50.4C71.6,88,0.4,155.2,0.4,243.2v9.6
        c0,88,71.2,155.2,158.4,155.2h50.4C297.2,408,368.4,340.8,368.4,252.8z"/>
    </g>
    <circle class="st2" cx="162.4" cy="248" r="142.4"/>
    <path class="st3" d="M62.4,147.2C117.6,92,208,92,263.2,147.2s55.2,145.6,0,200.8"/>
    </svg>'.html_safe
  end

  def toggle_on 
    '<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 496 496" style="enable-background:new 0 0 496 496;" xml:space="preserve">
    <style type="text/css">
      .st0{fill:#BBD689;}
      .st1{fill:#92A86F;}
      .st2{fill:#FFFFFF;}
      .st3{fill:#E9F4F2;}
    </style>
    <path style="fill:#BBD689;" class="st0" d="M496,252.8c0,88-71.2,155.2-158.4,155.2H158.4C71.2,408,0,340.8,0,252.8v-9.6C0,155.2,71.2,88,158.4,88h178.4
      c88,0,158.4,67.2,158.4,155.2v9.6H496z"/>
    <g>
      <path style="fill:#BBD689;" class="st1" d="M0,256l0-12.8C0,155.2,70.4,88,158.4,88h178.4c87.2,0,158.4,67.2,158.4,155.2V256"/>
      <path style="fill:#92A86F;" class="st1" d="M286.4,408h50.4c87.2,0,158.4-67.2,158.4-155.2v-9.6C495.2,155.2,424,88,336,88h-50.4
        c-87.2,0-158.4,67.2-158.4,155.2v9.6C127.2,340.8,198.4,408,286.4,408z"/>
    </g>
    <circle class="st2" cx="325.9" cy="248" r="142.4"/>
    <path class="st3" d="M226.1,147.2c55.2-55.2,145.6-55.2,200.8,0s55.2,145.6,0,200.8"/>
    </svg>'.html_safe
  end

  def on
    '<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496">
    <defs><style>.cls-1{fill:#bbd689;}.cls-2{fill:#92a86f;}.cls-3{fill:#fff;}.cls-4{fill:#e9f4f2;}</style></defs>
    <path class="cls-1" d="M496,252.8c0,88-71.2,155.2-158.4,155.2H158.4C71.2,408,0,340.8,0,252.8v-9.6C0,155.2,71.2,88,158.4,88H336.8c88,0,158.4,67.2,158.4,155.2v9.6Z"/>
    <path class="cls-2" d="M0,256V243.2C0,155.2,70.4,88,158.4,88H336.8c87.2,0,158.4,67.2,158.4,155.2V256"/>
    <path class="cls-2" d="M286.4,408h50.4c87.2,0,158.4-67.2,158.4-155.2v-9.6C495.2,155.2,424,88,336,88H285.6c-87.2,0-158.4,67.2-158.4,155.2v9.6C127.2,340.8,198.4,408,286.4,408Z"/>
    <circle class="cls-3" cx="325.9" cy="248" r="142.4"/><path class="cls-4" d="M226.1,147.2c55.2-55.2,145.6-55.2,200.8,0s55.2,145.6,0,200.8"/>
    </svg>'.html_safe
  end

  def off 
    '<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496"><defs>
    <style>.cls-1{fill:#e7e7e7;}.cls-2{fill:#aaaaa9;}.cls-3{fill:#fff;}.cls-4{fill:#e9f4f2;}</style>
    </defs><path class="cls-1" d="M496,252.8c0,88-71.2,155.2-158.4,155.2H158.4C71.2,408,0,340.8,0,252.8v-9.6C0,155.2,71.2,88,158.4,88H336.8c88,0,158.4,67.2,158.4,155.2v9.6Z"/>
    <path class="cls-2" d="M.4,256V243.2C.4,155.2,71.6,88,158.8,88H337.2c88,0,158.4,67.2,158.4,155.2V256"/>
    <path class="cls-2" d="M368.4,252.8v-9.6C368.4,155.2,297.2,88,210,88H159.6C71.6,88,.4,155.2.4,243.2v9.6C.4,340.8,71.6,408,158.8,408h50.4C297.2,408,368.4,340.8,368.4,252.8Z"/>
    <circle class="cls-3" cx="162.4" cy="248" r="142.4"/><path class="cls-4" d="M62.4,147.2C117.6,92,208,92,263.2,147.2s55.2,145.6,0,200.8"/>
    </svg>'.html_safe
  end

end
